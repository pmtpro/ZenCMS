tinymce.PluginManager.add("emoticons", function (e, t) {
    var list_smiles = e.settings.all_smile;
    function n() {
        var e;
        return e = '<table role="presentation" class="mce-grid">', tinymce.each(i, function (n) {
            e += "<tr>", tinymce.each(n, function (n) {
                var homes = t.split("//");
                var start = homes[0];
                var home1 = homes[1].split("/");
                var home = home1[0];
                var homeurl = start+"//"+home;
                var img = list_smiles[n];
                var patt = /src="(.*)"/;
                var m = img.match(patt);
                e += '<td><a href="#" data-mce-url="' + n + '" data-mce-img="'+ m[1] +'" tabindex="-1">' + img + '</a></td>'
            }), e += "</tr>"
        }), e += "<tr><td style='padding: 5px; vertical-align: middle'><a href='/account/settings/smiles' title='Chỉnh sửa danh sách smiles' onclick='location.href=\"/account/settings/smiles\";'>Sửa danh sách</a></td></tr></table>"
    }
    var data = e.settings.smile_list;
    var j = 0;
    var arr = Array();
    var out = Array();
    for (var x in data) {
        j = j + 1;
        arr.push(data[x]);
        if (j % 5 == 0) {
            out.push(arr);
            arr = Array();
        } else if (j == data.length) {
            out.push(arr);
        }
    }
    var i = out;
    e.addButton("emoticons", {type: "panelbutton", panel: {autohide: !0, html: n, onclick: function (t) {
        var n = e.dom.getParent(t.target, "a");
        var getsm = n.getAttribute("data-mce-url");
        var getimg = n.getAttribute("data-mce-img");
        n && (e.insertContent(getsm), this.hide())
    }}, tooltip: "Emoticons"})
});